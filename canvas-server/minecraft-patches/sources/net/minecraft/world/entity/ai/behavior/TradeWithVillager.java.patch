--- a/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java
+++ b/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java
@@ -77,9 +_,19 @@
     }
 
     private static Set<Item> figureOutWhatIAmWillingToTrade(Villager villager, Villager other) {
-        ImmutableSet<Item> set = other.getVillagerData().profession().value().requestedItems();
-        ImmutableSet<Item> set1 = villager.getVillagerData().profession().value().requestedItems();
-        return set.stream().filter(item -> !set1.contains(item)).collect(Collectors.toSet());
+        // Canvas start - remove streams
+        ImmutableSet<Item> otherItems = other.getVillagerData().profession().value().requestedItems();
+        ImmutableSet<Item> villagerItems = villager.getVillagerData().profession().value().requestedItems();
+        Set<Item> result = new java.util.HashSet<>();
+
+        for (Item item : otherItems) {
+            if (!villagerItems.contains(item)) {
+                result.add(item);
+            }
+        }
+
+        return result;
+        // Canvas end
     }
 
     private static void throwHalfStack(Villager villager, Set<Item> stack, LivingEntity entity) {
