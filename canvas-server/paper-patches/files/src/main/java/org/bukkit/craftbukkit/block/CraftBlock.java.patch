--- a/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java
+++ b/src/main/java/org/bukkit/craftbukkit/block/CraftBlock.java
@@ -6,6 +_,7 @@
 import java.util.Collections;
 import java.util.List;
 import java.util.stream.Collectors;
+import io.canvasmc.canvas.Config;
 import net.minecraft.core.BlockPos;
 import net.minecraft.core.Direction;
 import net.minecraft.server.level.ServerLevel;
@@ -332,7 +_,7 @@
 
     @Override
     public BlockState getState() {
-        return CraftBlockStates.getBlockState(this);
+        return CraftBlockStates.getBlockState(this, Config.INSTANCE.blocks.tileEntitySnapshotCreation); // Canvas - don't use snapshots for acquiring blockstate
     }
 
     // Paper start
@@ -548,15 +_,15 @@
         UseOnContext context = new UseOnContext(world, null, InteractionHand.MAIN_HAND, Items.BONE_MEAL.getDefaultInstance(), new BlockHitResult(Vec3.ZERO, direction, this.getPosition(), false));
 
         // SPIGOT-6895: Call StructureGrowEvent and BlockFertilizeEvent
-        world.captureTreeGeneration = true;
+        world.captureTreeGeneration.set(true); // Canvas - threadlocal
         InteractionResult result = BoneMealItem.applyBonemeal(context);
-        world.captureTreeGeneration = false;
+        world.captureTreeGeneration.set(false); // Canvas - threadlocal
 
-        if (!world.capturedBlockStates.isEmpty()) {
+        if (!world.capturedBlockStates.get().isEmpty()) { // Canvas - threadlocal
             TreeType treeType = SaplingBlock.treeType;
             SaplingBlock.treeType = null;
-            List<BlockState> states = new ArrayList<>(world.capturedBlockStates.values());
-            world.capturedBlockStates.clear();
+            List<BlockState> states = new ArrayList<>(world.capturedBlockStates.get().values()); // Canvas - threadlocal
+            world.capturedBlockStates.get().clear(); // Canvas - threadlocal
             StructureGrowEvent structureEvent = null;
 
             if (treeType != null) {
